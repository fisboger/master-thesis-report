\documentclass{report}
\usepackage{import}
\subimport{../../../}{preamble.tex}
\standalonetrue
\begin{document}

\begin{listing}[H]
    \begin{minted}[breaklines, linenos, breakanywhere]{diff}
--- "a/.\\unpatched tcpip.sys"
+++ "b/.\\patched tcpip.sys"
 void __fastcall Ipv6pReassembleDatagram(__int64 a1, struct_datagram *datagram, char a3) {
 unfragmentableHeaderLength = datagram->unfragmentableHeaderLength;
 packetSize = unfragmentableHeaderLength + datagram->fragmentableLength;
 BytesNeeded = unfragmentableHeaderLength + 40;
 v6 = *(_QWORD *)(*(_QWORD *)(a1 + 208) + 8i64);
 v7 = *(_QWORD *)(*(_QWORD *)v6 + 40i64);
 LockArray_high = HIDWORD(KeGetPcr()[1].LockArray);
-v11 = NetioAllocateAndReferenceNetBufferAndNetBufferList(IppReassemblyNetBufferListsComplete, datagram, 0i64, 0i64, 0, 0);
+if ( packetSize > 0xFFFF )
\end{minted}
\caption{Diff of patched and vulnerable \mintinline{c}{Ipv6pReassembleDatagram}}
\label{listing:diff:Ipv6pReassembleDatagram-c}
\end{listing}
\end{document}